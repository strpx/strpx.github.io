# 🎲 席くじ引きアプリ - ローカルストレージ版

ブラウザのローカルストレージを使用した席くじ引きWebアプリケーションです。サーバー不要で動作します。

## 📋 プロジェクト概要

このアプリは、イベントや会議などで席順を決める際に使用できる、シンプルで使いやすいくじ引きツールです。

### 主な機能

- ✅ **セッション作成**: 新しいくじ引きセッションを作成
- ✅ **セッション参加**: セッションIDで既存のセッションに参加
- ✅ **くじ引き実行**: 2秒のアニメーション付きで席番号を抽選
- ✅ **リアルタイム共有**: 同じブラウザの別タブ間で自動更新
- ✅ **重複防止**: 一度引かれた席は選ばれない
- ✅ **レスポンシブデザイン**: スマートフォンでも快適に使用可能
- ✅ **サーバー不要**: 完全にクライアントサイドで動作

### ⚠️ 重要な制限事項

このバージョンは **ローカルストレージ** を使用しているため：

- ✅ **同じブラウザの別タブ間**: リアルタイム共有可能
- ❌ **異なるデバイス**: データ共有不可
- ❌ **異なるブラウザ**: データ共有不可
- ✅ **インターネット接続**: 不要（オフラインでも動作）

**複数デバイスでの共有が必要な場合**: `index-with-api.html` を使用してください（開発環境のみ）

## 🚀 使い方

### 1. セッションを作成する

1. トップ画面で「セッション名」と「席の数」を入力
2. 「セッション作成」ボタンをクリック
3. 表示されたセッションIDをメモ

### 2. セッションに参加する（同じブラウザ）

1. **新しいタブ**でアプリを開く
2. 「セッションID」を入力
3. 「セッション参加」ボタンをクリック

### 3. くじを引く

1. 自分の名前を入力
2. 「🎯 くじを引く」ボタンをクリック
3. 2秒間のアニメーションが表示され、席番号が決定
4. 結果が画面に表示され、他のタブにも共有される

### 4. 結果を確認する

- 画面下部の「📊 抽選結果」セクションで全員の結果を確認
- リアルタイムで自動更新（3秒ごと）される

## 📁 ファイル構造

```
.
├── index.html              # メインアプリ（localStorage版）
├── index-with-api.html     # API版（開発環境用）
├── test.html               # APIテストページ
├── quick-test.html         # クイックテスト
├── DEPLOYMENT.md           # デプロイガイド
└── README.md               # このファイル
```

## 🛠 技術スタック

- **HTML5**: セマンティックなマークアップ
- **CSS3**: モダンなスタイリング、アニメーション
- **JavaScript (ES6+)**: 非同期処理、DOM操作
- **LocalStorage API**: データ永続化
- **Storage Events**: タブ間リアルタイム同期
- **Google Fonts**: Noto Sans JP フォント

## ✨ 実装済み機能

- [x] セッション作成機能
- [x] セッション参加機能（IDベース）
- [x] くじ引き実行とアニメーション（2秒）
- [x] 席番号の重複防止
- [x] リアルタイム結果共有（同じブラウザ内）
- [x] レスポンシブデザイン
- [x] セッションIDコピー機能
- [x] 結果の席番号順ソート表示
- [x] LocalStorage自動保存
- [x] Storage Eventによる同期

## 💾 データ保存

### LocalStorage構造

**sessions**: セッション情報
```json
[
  {
    "id": "sess_abc123",
    "session_id": "sess_abc123",
    "session_name": "テストセッション",
    "total_seats": 10,
    "status": "active",
    "created_at": "2025-10-25T12:00:00Z"
  }
]
```

**seat_assignments**: 席割り当て情報
```json
[
  {
    "id": "sess_xyz789",
    "session_id": "sess_abc123",
    "participant_name": "太郎",
    "seat_number": 5,
    "created_at": "2025-10-25T12:01:00Z"
  }
]
```

## 🔧 カスタマイズ

### ポーリング間隔の変更

`index.html` の `startPolling()` 関数内の値を変更：

```javascript
// 3000ミリ秒 = 3秒ごとに更新
pollingInterval = setInterval(() => {
    loadResults();
}, 3000); // この値を変更
```

### アニメーション時間の変更

`drawSeat()` 関数内の値を変更：

```javascript
if (counter >= 20) {  // 20回 × 100ms = 2秒
```

### カラーテーマの変更

`<style>` タグ内のグラデーション値を変更：

```css
background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
```

## 🔮 今後の拡張案

- [ ] データのエクスポート/インポート機能（JSON）
- [ ] セッション履歴の保存と再利用
- [ ] くじ引き結果のCSVダウンロード
- [ ] 席のグループ分け機能
- [ ] セッションのパスワード保護
- [ ] くじ引きの取り消し・やり直し機能
- [ ] ダークモード対応
- [ ] 音声効果（効果音）
- [ ] 結果のQRコード生成
- [ ] Firebase/Supabaseとの統合（複数デバイス対応）

## 🔧 トラブルシューティング

### セッションが見つからない

1. **正確なIDを入力**: スペースや改行が含まれていないか確認
2. **同じブラウザを使用**: Chrome→Chromeなど
3. **プライベートモード**: 通常モードとプライベートモードは別のストレージ

### データが消えた

LocalStorageは以下の場合にクリアされます：
- ブラウザのキャッシュクリア
- プライベートモードの終了
- ブラウザの設定でストレージをクリア

**対策**: 重要なセッションは手動でバックアップを取る

### リアルタイム更新が動かない

1. **同じブラウザ**: 異なるブラウザ間では同期しません
2. **Storage Event**: 一部の古いブラウザでは動作しません
3. **手動更新**: ページを再読み込みすれば最新状態が取得できます

### ブラウザがサポートされていない

LocalStorageは以下のブラウザでサポートされています：
- Chrome 4+
- Firefox 3.5+
- Safari 4+
- Edge (全バージョン)
- iOS Safari 3.2+
- Android Browser 2.1+

## 🎨 デザイン特徴

- グラデーション背景（紫系）
- カードベースのUI
- スムーズなアニメーション
- 直感的な操作性
- モバイルフレンドリー
- アクセシビリティ配慮

## 📝 ライセンス

このプロジェクトはフリーソフトウェアです。自由に使用、改変、配布できます。

---

**バージョン**: 2.0.0 (LocalStorage版)  
**最終更新**: 2025年10月25日  
**ステータス**: Production Ready ✅

## 🆚 バージョン比較

| 機能 | localStorage版 | API版 |
|------|---------------|-------|
| 複数デバイス共有 | ❌ | ✅ |
| インターネット不要 | ✅ | ❌ |
| サーバー不要 | ✅ | ❌ |
| 同じブラウザ内共有 | ✅ | ✅ |
| データ永続性 | ブラウザ依存 | サーバー保存 |
| セットアップ難易度 | 簡単 | 中程度 |

